# SEL Backend Server - Environment Configuration Template
# Copy this file to .env and configure with your actual values

# Server Configuration
SERVER_HOST=0.0.0.0
SERVER_PORT=8080
SERVER_BASE_URL=http://localhost:8080

# Public URL (for invitation links, must be HTTPS in production)
PUBLIC_URL=localhost:8080

# Database Configuration
DATABASE_URL=postgresql://sel_user:sel_password@localhost:5432/sel_dev?sslmode=disable
DATABASE_MAX_CONNECTIONS=25
DATABASE_MAX_IDLE_CONNECTIONS=5

# Bootstrap Admin User (FR-027)
# These credentials create the first admin user on initial startup
# After bootstrap, manage admins via admin UI/API
ADMIN_USERNAME=admin
ADMIN_PASSWORD=change_me_on_first_login
ADMIN_EMAIL=admin@example.com

# JWT Configuration
JWT_SECRET=your-secret-key-min-32-chars-change-in-production
JWT_EXPIRY_HOURS=24

# CSRF Protection (Security: server-fv1u)
# Required for production admin HTML routes to prevent cross-site request forgery
# Generate with: openssl rand -base64 32
# Minimum 32 characters required
# Optional in development (will log warning if missing in production)
CSRF_KEY=your-csrf-key-min-32-chars-change-in-production

# Rate Limiting (FR-020)
# For local development/testing, use higher limits to avoid throttling:
#   RATE_LIMIT_PUBLIC=10000, RATE_LIMIT_AGENT=20000, RATE_LIMIT_LOGIN=0
# For production, use conservative limits:
RATE_LIMIT_PUBLIC=60      # requests per minute (public endpoints)
RATE_LIMIT_AGENT=300      # requests per minute (agent endpoints with API key)
RATE_LIMIT_ADMIN=0        # 0 = unlimited (admin endpoints)
RATE_LIMIT_LOGIN=5        # login attempts per 15 minutes
RATE_LIMIT_FEDERATION=500 # federation sync requests per minute

# Trusted Proxy Configuration (Security: server-chgh)
# Comma-separated list of CIDR ranges for trusted proxies (load balancers, reverse proxies)
# Only requests from these IPs will have X-Forwarded-For/X-Real-IP headers trusted
# Leave empty to disable header trust (uses direct connection IP only)
# Example: TRUSTED_PROXY_CIDRS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
# TRUSTED_PROXY_CIDRS=

# CORS Configuration (Security: server-9hs)
# Development/test: allows all origins automatically
# Production: requires explicit whitelist (comma-separated)
# Example: CORS_ALLOWED_ORIGINS=https://sel.events,https://admin.sel.events,https://app.example.com
# CORS_ALLOWED_ORIGINS=

# Background Jobs (FR-029)
JOB_RETRY_DEDUPLICATION=1         # max attempts for dedup jobs
JOB_RETRY_RECONCILIATION=5        # max attempts for reconciliation
JOB_RETRY_ENRICHMENT=10           # max attempts for enrichment

# Environment
ENVIRONMENT=development  # development | test | production

# Logging
LOG_LEVEL=info  # debug | info | warn | error
LOG_FORMAT=json # json | console

# Email Configuration (Gmail SMTP)
# Gmail requires an App Password (NOT your regular Gmail password)
# To generate an App Password:
#   1. Enable 2-Step Verification on your Google Account
#   2. Visit https://myaccount.google.com/apppasswords
#   3. Generate a new App Password for "Mail" application
#   4. Use the 16-character password generated (no spaces)
EMAIL_ENABLED=false
EMAIL_FROM=noreply@togather.foundation
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-gmail-app-password
EMAIL_TEMPLATES_DIR=web/email/templates  # Path to email templates (relative or absolute)

# Federation
FEDERATION_NODE_NAME=local-dev
FEDERATION_SYNC_ENABLED=false

# External Services (optional)
# ARTSDATA_API_URL=https://api.artsdata.ca
# WIKIDATA_SPARQL_ENDPOINT=https://query.wikidata.org/sparql

# Feature Flags
ENABLE_VECTOR_SEARCH=false  # pgvector ready but not in MVP
ENABLE_AUTO_RECONCILIATION=false
